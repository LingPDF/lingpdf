<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="LingPDF"
           Version="1.0.0"
           Manufacturer="LingPDF Team"
           UpgradeCode="12345678-1234-1234-1234-123456789012">
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of LingPDF is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="LingPDF" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="PdfiumDLL" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>

    <Icon Id="AppIcon.ico" SourceFile="resources\windows\icon.ico" />
    <Property Id="ARPPRODUCTICON" Value="AppIcon.ico" />

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="LingPDF">
        <Component Id="MainExecutable" Guid="*">
          <File Source="$(var.PackageDir)\lingpdf.exe" KeyPath="yes" />
        </Component>
        <Component Id="PdfiumDLL" Guid="*">
          <File Source="$(var.PackageDir)\pdfium.dll" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>
    
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="LingPDF">
        <Component Id="ApplicationShortcut" Guid="*">
          <Shortcut Name="LingPDF"
                    Description="A lightweight PDF reader"
                    Target="[#lingpdf.exe]"
                    WorkingDirectory="INSTALLFOLDER" />
          <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
          <RegistryValue Root="HKCU" Key="Software\LingPDF" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>
  </Package>
</Wix>
